!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSLha=t()}}(function(){return function s(o,a,f){function u(e,t){if(!a[e]){if(!o[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(h)return h(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var n=a[e]={exports:{}};o[e][0].call(n.exports,function(t){return u(o[e][1][t]||t)},n,n.exports,s,o,a,f)}return a[e].exports}for(var h="function"==typeof require&&require,t=0;t<f.length;t++)u(f[t]);return u}({1:[function(t,e,r){"use strict";var i=t("./bit-eater"),n=t("./decoder");function s(t){this.data=t,this.bitstream=new i.BitStream(t),this.sequence=[],this.files={}}s.prototype.getSequence=function(){return this.sequence},s.prototype.getFiles=function(){return this.files},s.prototype.extract=function(t){var e=n.forMethod(this.sequence[t].method),r=this.sequence[t];return r.content=e.decode(r.data,r.uncompressedSize),r.content},s.prototype.extractByName=function(t){for(var e=0;e<this.sequence.length;e++)if(t==this.sequence[e].name)return this.extract(e);return[]},s.prototype.parseFile=function(){do{switch(this.peekNextHeaderLevel()){case 0:this.sequence.push(this.parseHeadersLevel0());break;case 1:this.sequence.push(this.parseHeadersLevel1())}}while(0!=this.peekNextHeaderSize());this.files={};for(var t=0;t<this.sequence.length;t++)this.files[this.sequence[t].name]=this.sequence[t];return this.files},s.prototype.peekNextHeaderSize=function(){return this.bitstream.view.getUint8(this.bitstream.index)},s.prototype.peekNextHeaderLevel=function(){return this.bitstream.view.getUint8(this.bitstream.index+160)},s.prototype.parseHeadersLevel0=function(){var t={headerSize:this.bitstream.readUint8(),headerCRC:this.bitstream.readUint8(),method:this.bitstream.readASCIIString(5),compressedSize:this.bitstream.readUint32(),uncompressedSize:this.bitstream.readUint32(),originalTimestamp:this.bitstream.readUint32(),fileAttribute:this.bitstream.readUint8(),level:this.bitstream.readUint8(),filenameLength:this.bitstream.readUint8(),content:null,isDir:!1,asUint8Array:function(){return this.content}},e=this.bitstream.readASCIIString(t.filenameLength),r=this.bitstream.readUint16(),i=this.bitstream.readArrayBuffer(t.compressedSize);return t.name=e,t.originalFileCRC16=r,t.data=i,t.lastModifiedDate=new Date(1e3*t.originalTimestamp),t},s.prototype.parseHeadersLevel1=function(){this.bitstream._index;for(var t={headerSize:this.bitstream.readUint8(),headerCRC:this.bitstream.readUint8(),method:this.bitstream.readASCIIString(5),compressedSize:this.bitstream.readUint32(),uncompressedSize:this.bitstream.readUint32(),originalTimestamp:this.bitstream.readUint32(),fileAttribute:this.bitstream.readUint8(),level:this.bitstream.readUint8(),filenameLength:this.bitstream.readUint8(),content:null,isDir:!1,asUint8Array:function(){return this.content}},e=this.bitstream.readASCIIString(t.filenameLength),r=this.bitstream.readUint16(),i=this.bitstream.readASCIIString(1),n=[],s=0,o=this.bitstream.readUint16();0<o;){s+=o;for(var a=[],f=0;f<o-2;f++)a.push(this.bitstream.readUint8());n.push(a),o=this.bitstream.readUint16()}t.compressedSize=t.compressedSize-s;var u=this.bitstream.readArrayBuffer(t.compressedSize);return t.osId=i,t.extraHeaders=n,t.name=e,t.originalFileCRC16=r,t.data=u,t.lastModifiedDate=new Date(1e3*t.originalTimestamp),t},e.exports=s},{"./bit-eater":2,"./decoder":3}],2:[function(t,e,r){"use strict";var n={BIG_ENDIAN:1,LITTLE_ENDIAN:2},s=function(t,e,r,i){if(t instanceof Uint8Array&&(t=t.buffer),!(t instanceof ArrayBuffer||"undefined"!=typeof Buffer&&t instanceof Buffer))throw new Error("Must specify a valid ArrayBuffer or Buffer.");e=e||0,r=r||t.byteLength||t.length,this.endianness=i||n.BIG_ENDIAN,this._view=new Uint8Array(t,e,r)};Object.defineProperty(s.prototype,"buffer",{get:function(){return"undefined"!=typeof Buffer?Buffer.from(this._view.buffer):this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(s.prototype,"byteLength",{get:function(){return this._view.length},enumerable:!0,configurable:!1}),s.prototype._setBit=function(t,e){e?this._view[t>>3]|=1<<7-(7&t):this._view[t>>3]&=~(1<<7-(7&t))},s.prototype.getBits=function(t,e,r){if(32<e)throw new Error("Too many bits read");var i=8*this._view.length-t;if(i<e)throw new Error("Cannot get "+e+" bit(s) from offset "+t+", "+i+" available");for(var n=0,s=0;s<e;){var o=e-s,a=7&t,f=this._view[t>>3],u=Math.min(o,8-a),h=(1<<u)-1;n|=8<a+o?(f&h)<<e-s-u:f>>8-a-o&h,t+=u,s+=u}return r?(32!==e&&n&1<<e-1&&(n|=-1^(1<<e)-1),n):n>>>0},s.prototype.setBits=function(t,e,r){var i=8*this._view.length-t;if(i<r)throw new Error("Cannot set "+r+" bit(s) from offset "+t+", "+i+" available");for(var n=0;n<r;){var s,o=r-n;if(8<=r-n&&0==(7&t))this._view[t>>3]=e&255<<o-8>>o-8,s=8;else{var a=1<<o-1;this._setBit(t,e&a),s=1}t+=s,n+=s}},s.prototype.fixEndianness=function(t){var e=0;this.endianness==n.LITTLE_ENDIAN&&t.reverse();for(var r=0;r<t.length;r++)e|=t[r]<<8*r;return e},s.prototype.getBoolean=function(t){return 0!==this.getBits(t,1,!1)},s.prototype.getInt8=function(t){return this.getBits(t,8,!0)},s.prototype.getUint8=function(t){return this.getBits(t,8,!1)},s.prototype.getInt16=function(t){return this.fixEndianness([this.getBits(t,8,!1),this.getBits(t+8,8,!0)])},s.prototype.getUint16=function(t){return this.fixEndianness([this.getBits(t,8,!1),this.getBits(t+8,8,!1)])>>>0},s.prototype.getInt32=function(t){return this.fixEndianness([this.getUint8(t),this.getUint8(t+8),this.getUint8(t+16),this.getInt8(t+24)])},s.prototype.getUint32=function(t){return this.fixEndianness([this.getUint8(t),this.getUint8(t+8),this.getUint8(t+16),this.getUint8(t+24)])>>>0},s.prototype.setBoolean=function(t,e){this.setBits(t,e?1:0,1)},s.prototype.setInt8=s.prototype.setUint8=function(t,e){this.setBits(t,e,8)},s.prototype.setBytes=function(t,e){this.endianness==n.LITTLE_ENDIAN&&e.reverse();for(var r=0;r<e.length;r++)this.setBits(t+8*r,e[r],8)},s.prototype.setInt16=s.prototype.setUint16=function(t,e){var r=255&e,i=e>>8;this.setBytes(t,[r,i])},s.prototype.setInt32=s.prototype.setUint32=function(t,e){for(var r=[],i=0;i<4;i++)r.push(255&e),e>>=8;this.setBytes(t,r)},s.prototype.getArrayBuffer=function(t,e){for(var r=new Uint8Array(e),i=0;i<e;i++)r[i]=this.getUint8(t+8*i);return r};var i=function(e,r){return function(){if(this._index+r>this._length)throw new Error("Trying to read past the end of the stream");var t=this._view[e](this._index);return this._index+=r,t}},o=function(e,r){return function(t){this._view[e](this._index,t),this._index+=r}};function a(t,e){return function(t,e){if(0===e)return"";var r=0,i=[],n=!0,s=!!e;e||(e=Math.floor((t._length-t._index)/8));for(;r<e;){var o=t.readUint8();if(0===o&&(n=!1,!s))break;n&&i.push(o),r++}return String.fromCharCode.apply(null,i)}(t,e)}var f=function(t,e,r,i){t instanceof Uint8Array&&(t=t.buffer);var n=t instanceof ArrayBuffer||"undefined"!=typeof Buffer&&t instanceof Buffer;if(!(t instanceof s||n))throw new Error("Must specify a valid BitView, ArrayBuffer or Buffer");this._view=n?new s(t,e,r,i):t,this._index=0,this._startIndex=0,this._length=8*this._view.byteLength};Object.defineProperty(f.prototype,"index",{get:function(){return this._index-this._startIndex},set:function(t){this._index=t+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"length",{get:function(){return this._length-this._startIndex},set:function(t){this._length=t+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"bitsLeft",{get:function(){return this._length-this._index},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"byteIndex",{get:function(){return Math.ceil(this._index/8)},set:function(t){this._index=8*t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"buffer",{get:function(){return this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!1}),f.prototype.readBits=function(t,e){var r=this._view.getBits(this._index,t,e);return this._index+=t,r},f.prototype.writeBits=function(t,e){this._view.setBits(this._index,t,e),this._index+=e},f.prototype.readBoolean=i("getBoolean",1),f.prototype.readInt8=i("getInt8",8),f.prototype.readUint8=i("getUint8",8),f.prototype.readInt16=i("getInt16",16),f.prototype.readUint16=i("getUint16",16),f.prototype.readInt32=i("getInt32",32),f.prototype.readUint32=i("getUint32",32),f.prototype.writeBoolean=o("setBoolean",1),f.prototype.writeInt8=o("setInt8",8),f.prototype.writeUint8=o("setUint8",8),f.prototype.writeInt16=o("setInt16",16),f.prototype.writeUint16=o("setUint16",16),f.prototype.writeInt32=o("setInt32",32),f.prototype.writeUint32=o("setUint32",32),f.prototype.readASCIIString=function(t){return a(this,t)},f.prototype.writeASCIIString=function(t,e){!function(t,e,r){for(var i=r||e.length+1,n=0;n<i;n++)t.writeUint8(n<e.length?e.charCodeAt(n):0)}(this,t,e)},f.prototype.readBitStream=function(t){var e=new f(this._view);return e._startIndex=this._index,e._index=this._index,e.length=t,this._index+=t,e},f.prototype.writeBitStream=function(t,e){var r;for(e||(e=t.bitsLeft);0<e;)r=Math.min(e,8),this.writeBits(t.readBits(r),r),e-=r},f.prototype.readArrayBuffer=function(t){var e=this._view.getArrayBuffer(this._index,t);return this._index+=8*t,e},f.prototype.writeArrayBuffer=function(t,e){this.writeBitStream(new f(t),8*e)},e.exports={BitView:s,BitStream:f,Endianness:n}},{}],3:[function(t,e,r){"use strict";var i=t("./new_decoder"),n=t("./null_decoder");function s(){}s.forMethod=function(t){switch(t){case"-lh0-":return new n;case"-lh5-":var e=i.getNewDecoderConfig(14,4);return new i.NewDecoder(e);default:return null}},e.exports=s},{"./new_decoder":5,"./null_decoder":6}],4:[function(t,e,r){"use strict";var i=t("./archive");function n(t){if(!(this instanceof n))return new n(t);this.content=t,this.archive=new i(t),this.archive.parseFile();for(var e=0;e<this.archive.sequence.length;e++){var r=this.archive.extract(e);this.archive.sequence[e].content=r}this.files=this.archive.sequence}n.prototype.file=function(t){if("[object RegExp]"===Object.prototype.toString.call(t)){var r=t;return this.filter(function(t,e){return!e.dir&&r.test(t)})}var i=t;return this.filter(function(t,e){return!e.dir&&t===i})[0]||null},n.prototype.folder=function(t){return[]},n.prototype.filter=function(t){for(var e=[],r=0;r<this.files.length;r++)e.push(this.files[r]);return e},e.exports=n},{"./archive":1}],5:[function(t,e,r){"use strict";var s=t("./bit-eater"),o=t("./tree");function i(t){if(!(this instanceof i))return new i(t);this.options=t,this.ringBuffer=a(t.ringBufferSize,0),this.ringBufferPosition=0,this.blockRemaining=0,this.codeTree=new o.Tree(2*t.numCodes),this.offsetTree=new o.Tree(2*t.maxTempCodes),this.outputStream=[]}function a(t,e){for(var r=new Array(t);0<=--t;)r[t]=e;return r}i.prototype.decode=function(t,e){this.bitstream=new s.BitStream(t.buffer,null,null,s.Endianness.LITTLE_ENDIAN);var r=t.length,i=0;do{var n=this.readAndOutput();if(!n)throw new Error("Decoding failed: got nothing");i+=n}while(0<r&&i<e);return this.options.outputBufferSize,this.bitstream=null,this.outputStream},i.prototype.readLength=function(){var t=this.bitstream.readBits(3);if(t<0)return-1;if(7==t)for(;;){var e=this.bitstream.readBits(1);if(e<0)return-1;if(0==e)break;t++}return t},i.prototype.readTempTable=function(){var t=this.bitstream.readBits(5);if(t<0)return 0;if(0==t){var e=this.bitstream.readBits(5);return e<0?0:(this.offsetTree.setSingle(e),1)}t=Math.min(t,this.options.maxTempCodes);for(var r=[],i=0;i<t;i++){var n=this.readLength();if(n<0)return 0;if(r.push(n),2==i){if((n=this.bitstream.readBits(2))<0)return 0;for(var s=0;s<n;s++)i++,r.push(0)}}o.buildTree(this.offsetTree,2*this.options.maxTempCodes,r,t)},i.prototype.readAndOutput=function(){for(;0==this.blockRemaining;)if(!this.startNewBlock())return 0;--this.blockRemaining;var t=this.codeTree.read(this.bitstream);return t<0?0:t<256?this.outputByte(t):this.copyFromHistory(t-256+this.options.copyThreshold)};i.prototype.outputByte=function(t){return this.outputStream.push(t),this.ringBuffer[this.ringBufferPosition]=t,this.ringBufferPosition=(this.ringBufferPosition+1)%this.options.ringBufferSize,1},i.prototype.copyFromHistory=function(t){var e=this.readOffsetCode();if(!(e<0)){for(var r=this.ringBufferPosition+this.options.ringBufferSize-e-1,i=0;i<t;i++)this.outputByte(this.ringBuffer[(r+i)%this.options.ringBufferSize]);return t}},i.prototype.readOffsetCode=function(){var t=this.offsetTree.read(this.bitstream);if(t<0)return-1;if(0==t)return 0;if(1==t)return 1;var e=this.bitstream.readBits(t-1);return e<0?-1:e+(1<<t-1)},i.prototype.startNewBlock=function(){var t=this.bitstream.readBits(16);return t<0?0:(this.blockRemaining=t,this.readTempTable()&&this.readCodeTable()&&this.readOffsetTable()?1:0)},i.prototype.readSkipCount=function(t){var e=0;if(0==t)e=1;else if(1==t){if((e=this.bitstream.readBits(4))<0)return-1;e+=3}else{if((e=this.bitstream.readBits(9))<0)return-1;e+=20}return e},i.prototype.readTempTable=function(){var t=a(this.options.maxTempCodes,0),e=this.bitstream.readBits(5,!1);if(e<0)return 0;if(0==e){var r=this.bitstream.readBits(5);return r<0?0:(this.offsetTree.setSingle(r),1)}e=Math.min(e,this.options.maxTempCodes);for(var i=0;i<e;i++){var n=this.readLength();if(n<0)return 0;if(t[i]=n,2==i){if((n=this.bitstream.readBits(2))<0)return 0;for(var s=0;s<n;s++)t[++i]=0}}return o.buildTree(this.offsetTree,2*this.options.maxTempCodes,t,e),1},i.prototype.readCodeTable=function(){var t,e=a(this.options.numCodes,0),r=this.bitstream.readBits(9);if(r<0)return 0;if(0==r)return(t=this.bitstream.readBits(9))<0?0:(this.codeTree.setSingle(t),1);r=Math.min(r,this.options.numCodes);for(var i=0;i<r;){if((t=this.offsetTree.read(this.bitstream))<0)return 0;if(t<=2){var n=this.readSkipCount(t);if(n<0)return 0;for(var s=0;s<n&&i<r;s++)e[i]=0,i++}else e[i]=t-2,i++}return o.buildTree(this.codeTree,2*this.options.numCodes,e,r),1},i.prototype.readOffsetTable=function(){var t=a(this.options.historyBits,0),e=this.bitstream.readBits(this.options.offsetBits);if(e<0)return 0;if(0==e){var r=this.bitstream.readBits(this.options.offsetBits);return r<0?0:(this.offsetTree.setSingle(r),1)}e=Math.min(e,this.options.historyBits);for(var i=0;i<e;i++){var n=this.readLength();if(n<0)return 0;t[i]=n}return o.buildTree(this.offsetTree,2*this.options.maxTempCodes,t,e),1},e.exports={NewDecoder:i,getNewDecoderConfig:function(t,e){var r=1<<t;return{copyThreshold:3,historyBits:t,offsetBits:e,ringBufferSize:r,outputBufferSize:r,numCodes:510,maxTempCodes:20}}}},{"./bit-eater":2,"./tree":7}],6:[function(t,e,r){"use strict";function i(){}i.prototype.decode=function(t,e){return t.length==e?t:[]},e.exports=i},{}],7:[function(t,e,r){"use strict";var a=1<<63;function i(t){this.tree=[];for(var e=t;0<e;)this.tree.push(a),e--}function o(t){var e=2*(t.treeAllocated-t.nextEntry);if(!(t.treeAllocated+e>t.treeLen))for(var r=t.treeAllocated;t.nextEntry<r;)t.tree.tree[t.nextEntry]=t.treeAllocated,t.treeAllocated+=2,t.nextEntry++}function f(t,e,r,i){for(var n=0,s=0;s<r;s++)if(e[s]==i){var o=u(t);t.tree.tree[o]=s|a}else e[s]>i&&(n=1);return n}function u(t){if(t.nextEntry>=t.treeAllocated)return 0;var e=t.nextEntry;return t.nextEntry++,e}i.prototype.read=function(t){for(var e=this.tree[0];0==(e&a);){var r=t.readBits(1);if(r<0)return-1;e=this.tree[e+r]}return e&~a},i.prototype.setSingle=function(t){this.tree[0]=t|a},e.exports={Tree:i,buildTree:function(t,e,r,i){for(var n={tree:t,treeLen:e,nextEntry:0,treeAllocated:1},s=0;o(n),f(n,r,i,++s););}}},{}]},{},[4])(4)});